window.addEventListener('DOMContentLoaded',function(){ 





    $(document).ready(function() {

       

        var start_price = $('.goods_price').text()  // 개당가격 표시할 변수!
        
        var number = $('.inp').val();                  //구매 수량을 조절할 변수 ! (inp클래스 초기 value값은 1로 헸음! 시작 수량이 1이니깐)
        var cost = $('.goods_price input').val(); ;    // 상품의 가격을 설정해줘야됨.  goods_price안에있는 input의 value값에 탬플릿 언어로 반찬 가격을 불러와야됨 

        $('.price .num').text(start_price);             // 첫 화면의 총 상품금액 (.price 안에 .num) 에다가 초기 가격을 출력!
        
    
        

        //수량 조절 함수 시작
        $('.down').click(function(){               // 수량 내리기 버튼을 클릭할 때 발동!  
            if(number >= 0){                        // 만약에 수량이 0보다 많으면 ?
                number--;                          // 목적대로 수량을 1 깍음
                $(".inp").val(number);  			   // 깍았으니 수량클래스(.inp)의 값을 바꿔줌
                           
                
                }   
             else if(number > 0){             //0 이하면 false 반환
              return false;
            }
    		
            

             
                
            
    
            
    
            
            
        
            
            
        });
    
    
    
        $('.up').click(function(){            // 수량올리기 버튼 클릭하면?
            number++;// 수량을 1 올려줌
            $(".inp").val(number);  // 올렸으니 수량클래스(.inp)의 값을 바꿔줌
            // if((number*cost % 1000) == 0){  //만약에 수량x가격이 1000으로 나눴을떄 0 이면(ex 3000 4000 5000) 몫 + 콤마 + 000 을 붙임
            //     $(".num").text(Math.floor(number*cost/1000) + ',' + '000');
            // }

            // else if(number*cost < 1000){  // 만약에 수량x가격이 1000이하면 그냥 수량x가격으로 추력
            //     $(".num").text(number*cost);
            // }
    
            // else{  // 그외 나머지는 수량x가격의 몫+ 콤마 + 나머지 로 출력
            //     $(".num").text(Math.floor(number*cost/1000) + ',' + number*cost%1000);
                
    
            // }
            $(".num").text(comma(number*cost));
    
    
    
            
            $('.emph').text(comma((number*cost)/20) + '원 적립');  // 마찬가지로 적립금 은 가격x수량x0.05로 출력
            
    
            
        });



       





        function comma(num){                       //콤마찍는 함수
            var len, point, str; 
               
            num = num + ""; 
            point = num.length % 3 ;
            len = num.length; 
           
            str = num.substring(0, point); 
            while (point < len) { 
                if (str != "") str += ","; 
                str += num.substring(point, point + 3); 
                point += 3; 
            } 
             
            return str;
         
        }











    });

});